<!-- Zoom Mode Indicator -->
@if (isZoomed()) {
<div class="zoom-indicator">
  <mat-icon>zoom_in</mat-icon>
  <span i18n="@@demo.dashboard.zoomModeActive">Zoom Mode Active</span>
</div>
}

<div class="dashboard-viewport-container">
  <div class="dashboard-wrapper">
    <ngx-dashboard
      #dashboard
      [dashboardData]="dashboardConfig"
      [editMode]="editMode()"
      [reservedSpace]="dashboardReservedSpace()"
      [enableSelection]="selectMode()"
      (selectionComplete)="onSelectionComplete($event)"
    >
    </ngx-dashboard>
  </div>

  @if (editMode()) {
  <div class="widget-list-container" [class.collapsed]="isWidgetListCollapsed()">
    <div
      class="widget-list-header"
      (click)="toggleWidgetList()"
      (keydown.enter)="toggleWidgetList()"
      (keydown.space)="toggleWidgetList(); $event.preventDefault()"
      role="button"
      tabindex="0"
      [attr.aria-label]="isWidgetListCollapsed() ? 'Expand widget list (Ctrl+B)' : 'Collapse widget list (Ctrl+B)'"
      [attr.aria-expanded]="!isWidgetListCollapsed()"
      [matTooltip]="isWidgetListCollapsed() ? 'Click to expand widgets (Ctrl+B)' : 'Click to collapse widgets (Ctrl+B)'"
      i18n-matTooltip="@@demo.dashboard.toggleWidgetListHeader"
      matTooltipPosition="left"
    >
      <mat-icon class="widgets-icon">dashboard</mat-icon>
      @if (!isWidgetListCollapsed()) {
      <span class="widgets-title" i18n="@@demo.dashboard.widgetsTitle">Widgets</span>
      }
    </div>
    <ngx-dashboard-widget-list class="widget-list"></ngx-dashboard-widget-list>
  </div>
  }
</div>

<!-- Selection Mode: Cancel Button -->
@if (selectMode()) {
<button
  mat-fab
  class="cancel-selection-fab"
  (click)="cancelSelect()"
  matTooltip="Cancel Selection (ESC)"
  i18n-matTooltip="@@demo.dashboard.cancelSelectionEsc"
  matTooltipPosition="left"
  color="warn"
>
  <mat-icon>close</mat-icon>
</button>
}

<!-- Zoom Mode: Exit Zoom FAB -->
@if (isZoomed()) {
<button
  mat-fab
  class="exit-zoom-fab"
  (click)="exitZoom()"
  matTooltip="Exit Zoom (ESC)"
  i18n-matTooltip="@@demo.dashboard.exitZoomEsc"
  matTooltipPosition="left"
  color="accent"
>
  <mat-icon>zoom_out</mat-icon>
</button>
}

<!-- Normal Mode: Dashboard FAB with Speed Dial -->
@if (!selectMode() && !isZoomed()) {
<app-dashboard-fab
  #fab
  [editMode]="editMode()"
  [selectMode]="selectMode()"
  (editModeToggle)="onEditModeToggle()"
  (exportToFile)="onExportToFile()"
  (importFromFile)="onImportFromFile()"
  (saveToLocalStorage)="onSaveToLocalStorage()"
  (loadFromLocalStorage)="onLoadFromLocalStorage()"
  (clearDashboard)="onClearDashboard()"
  (resetToDefault)="onResetToDefault()"
  (selectToggle)="onSelectToggle()"
></app-dashboard-fab>
}
