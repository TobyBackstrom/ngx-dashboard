const fs = require('fs');
const path = require('path');

const libraries = [
  {
    name: 'ngx-dashboard',
    packageJsonPath: 'projects/ngx-dashboard/package.json',
    versionFilePath: 'projects/ngx-dashboard/src/lib/version.ts',
    constantName: 'NGX_DASHBOARD_VERSION'
  },
  {
    name: 'ngx-dashboard-widgets',
    packageJsonPath: 'projects/ngx-dashboard-widgets/package.json',
    versionFilePath: 'projects/ngx-dashboard-widgets/src/lib/version.ts',
    constantName: 'NGX_DASHBOARD_WIDGETS_VERSION'
  }
];

libraries.forEach(lib => {
  const packageJson = JSON.parse(fs.readFileSync(lib.packageJsonPath, 'utf8'));
  const version = packageJson.version;

  const content = `// Auto-generated by scripts/generate-versions.js
// Do not edit manually
export const ${lib.constantName} = '${version}';
`;

  fs.writeFileSync(lib.versionFilePath, content, 'utf8');
  console.log(`✓ Generated ${lib.name} version.ts (v${version})`);
});

console.log('✓ All version files generated successfully');
